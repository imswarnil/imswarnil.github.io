// ======================================================================
// page.scss — Page layout with sticky aside & auto TOC
// (Main content is CLEAN: no island border/shadow/background.)
// Depends on: _variables.scss
// ======================================================================

@use "variables" as *;

.page { padding-block: clamp($sp-10, 4vw, $sp-16); }

/* Grid: main + optional aside */
.page-layout {
  display: grid;
  grid-template-columns: 1fr;
  gap: clamp($sp-10, 3vw, $sp-16);

  @include mq-up($bp-lg) {
    grid-template-columns: minmax(0, 1fr) 320px; // main | aside
    align-items: start;
  }
}

/* Breadcrumbs */
.page-breadcrumbs { margin-bottom: $sp-7; }
.page-breadcrumbs__list {
  margin: 0; padding: 0; list-style: none; display: flex; flex-wrap: wrap; gap: $sp-5; align-items: center;
  @include theme-block      { color: tone(secondary, light); }
  @include theme-block-dark { color: tone(secondary, dark);  }
  a { text-decoration: none; }
  .sep { opacity: .6; }
  .current { @include theme-block{ color: tone(contrast, light); } @include theme-block-dark{ color: tone(contrast, dark); } }
}

/* Main article */
.page-main { min-width: 0; }
.page-article {
  display: block;
  padding: 0;                     // no island padding — let content decide
  border: 0; box-shadow: none;    // <- CLEAN (no border/shadow)
  background: transparent;        // <- CLEAN

  .page-head { margin-bottom: clamp($sp-7, 2.4vw, $sp-10); }
  .page-title {
    margin: 0 0 $sp-4 0;
    font-size: clamp($fs-8, 5.6vw, $fs-10);
    line-height: $lh-tight;
    font-weight: $fw-bold;
  }

  .page-meta {
    margin: 0 0 $sp-8 0; display: flex; flex-wrap: wrap; gap: $sp-6; font-size: $fs-2;
    @include theme-block      { color: tone(secondary, light); }
    @include theme-block-dark { color: tone(secondary, dark);  }
    .page-meta__item { display: inline-flex; align-items: center; gap: $sp-4; }
  }

  .page-body {
    /* rhythm for content; keep simple */
    :where(h2,h3){ margin: $sp-10 0 $sp-6; line-height: $lh-tight; }
    :where(p,ul,ol,pre,table,blockquote){ margin-bottom: $sp-6; }
    :where(img, video, svg, canvas) { max-width: 100%; height: auto; display: block; }
    table { display: block; overflow-x: auto; }
    blockquote {
      margin: $sp-10 0; padding: $sp-7 $sp-10; border-left: 3px solid;
      @include theme-block      { border-color: tone(border, light); background: tone(background-100, light); }
      @include theme-block-dark { border-color: tone(border, dark);  background: tone(background-200, dark); }
    }
  }

  /* Footer widgets (inline) */
  .page-foot { margin-top: clamp($sp-12, 4vw, $sp-16); display: grid; gap: $sp-10; }
  .page-tags {
    margin: 0; padding: 0; list-style: none; display: flex; flex-wrap: wrap; gap: $sp-6;
    .tag {
      display: inline-flex; align-items: center; gap: $sp-5;
      padding: .35rem .7rem; border-radius: $radius-pill; border: 1px solid;
      @include theme-block      { background: tone(surface, light); border-color: tone(border, light); }
      @include theme-block-dark { background: tone(surface, dark);  border-color: tone(border, dark);  }
      text-decoration: none; font-size: $fs-2;
    }
  }
  .page-share { display: flex; flex-wrap: wrap; gap: $sp-6; }
  .share-btn {
    @include button-base;
    background: transparent; border-color: tone(border, light);
    @include theme-block      { color: tone(contrast, light); border-color: tone(border, light); }
    @include theme-block-dark { color: tone(contrast, dark);  border-color: tone(border, dark);  }
    i { font-size: 1.1em; }
    &:hover {
      @include theme-block      { background: tone(background-100, light); }
      @include theme-block-dark { background: tone(background-200, dark);  }
    }
  }

  .page-nav {
    display: flex; justify-content: space-between; align-items: center; gap: $sp-7;
    .page-nav__link {
      display: inline-flex; align-items: center; gap: $sp-5; text-decoration: none; border: 1px solid transparent; padding: $sp-5 $sp-6; border-radius: $radius-3;
      @include theme-block      { color: tone(contrast, light); }
      @include theme-block-dark { color: tone(contrast, dark);  }
      &:hover {
        @include theme-block      { background: tone(background-100, light); border-color: tone(border, light); }
        @include theme-block-dark { background: tone(background-200, dark);  border-color: tone(border, dark);  }
      }
    }
    .prev i { order: 0; } .next i { order: 2; }
  }
}

/* Related (after article) */
.page-related {
  margin-top: clamp($sp-12, 5vw, $sp-16);
  .page-related__title { margin: 0 0 $sp-6 0; font-size: $fs-5; }
  .page-related__list { margin: 0; padding: 0; list-style: none; display: grid; gap: $sp-5; }
  .page-related__item {
    display: block; text-decoration: none; border: 1px solid transparent; padding: $sp-5 $sp-6; border-radius: $radius-3;
    @include theme-block      { color: tone(contrast, light); }
    @include theme-block-dark { color: tone(contrast, dark);  }
    &:hover {
      @include theme-block      { background: tone(background-100, light); border-color: tone(border, light); }
      @include theme-block-dark { background: tone(background-200, dark);  border-color: tone(border, dark);  }
    }
  }
}

/* Aside (sticky on desktop) */
.page-aside {
  display: none;
  @include mq-up($bp-lg) {
    display: grid;
    gap: $sp-8;
    position: sticky;
    top: calc(#{$navbar-height} + #{$sp-8});
    align-self: start;
  }
}

/* Sidebar cards (light touch, not heavy islands) */
.page-card {
  border-radius: $radius-5;
  padding: $sp-8;
  border: 1px solid;
  box-shadow: none; // softer
  @include theme-block      { background: transparent; border-color: tone(border, light); }
  @include theme-block-dark { background: transparent; border-color: tone(border, dark);  }

  &__title { margin: 0 0 $sp-6 0; font-size: $fs-5; font-weight: $fw-semibold; line-height: $lh-tight; }
  &__text  { margin: 0 0 $sp-6 0; font-size: $fs-3;
    @include theme-block      { color: tone(foreground, light); }
    @include theme-block-dark { color: tone(foreground, dark);  }
  }
}

/* TOC */
.page-toc-list { list-style: none; margin: 0; padding: 0; display: grid; gap: $sp-4; }
.page-toc-item.is-sub { padding-left: $sp-6; }
.page-toc-link {
  display: block; padding: $sp-4 $sp-5; border-radius: $radius-3; border: 1px solid transparent; text-decoration: none; font-size: $fs-2;
  @include theme-block      { color: tone(contrast, light); }
  @include theme-block-dark { color: tone(contrast, dark);  }
  &:hover {
    @include theme-block      { background: tone(background-100, light); border-color: tone(border, light); }
    @include theme-block-dark { background: tone(background-200, dark);  border-color: tone(border, dark);  }
  }
}

/* Social list */
.page-social {
  list-style: none; margin: 0; padding: 0; display: grid; gap: $sp-5;
}
.page-social__link {
  display: inline-flex; align-items: center; gap: $sp-5; padding: $sp-5 $sp-6; border: 1px solid transparent; border-radius: $radius-3; text-decoration: none; font-size: $fs-3;
  @include theme-block      { color: tone(contrast, light); }
  @include theme-block-dark { color: tone(contrast, dark);  }
  i { font-size: 1.1em; }
  &:hover {
    @include theme-block      { background: tone(background-100, light); border-color: tone(border, light); }
    @include theme-block-dark { background: tone(background-200, dark);  border-color: tone(border, dark);  }
  }
}

/* CTA button uses your tokens */
.btn { @include button-base; }
.button {
  @include theme-block      { background: tone(accent, light); color: tone(white, light); }
  @include theme-block-dark { background: tone(white, dark);  color: tone(black, dark); }
  border-color: transparent;
  &:hover {
    transform: translateY(-2px);
    box-shadow: 0 4px 12px rgba(0,0,0,0.12);
    @include theme-block      { color: tone(white, light); }
    @include theme-block-dark { color: tone(black, dark); }
  }
}
.page-related__list { grid-template-columns: 1fr; }
@media (min-width: $bp-md) {
  .page-related__list { display: grid; grid-template-columns: 1fr 1fr; gap: $sp-6; }
}

