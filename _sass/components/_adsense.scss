// ======================================================================
// adsense.scss — Responsive AdSense + theme-aware placeholder (fixed)
// Depends on: _variables.scss
// ======================================================================

@use "variables" as *;

/* Wrapper spacing + centering */
.ad {
  margin-block: clamp($sp-10, 4vw, $sp-16);

  /* Constrain to parent; don't bleed past gutters */
  width: 100%;
  max-width: 100%;

  /* Create space for the top ribbon label */
  padding-top: $sp-7;

  /* Layer context for the ribbon */
  position: relative;

  /* Center the slot without forcing extra width */
  display: grid;
  place-items: center;
}


/* Core slot: fluid within parent, no overflow */
.adsbygoogle.ad__slot {
  display: block;
  width: 100%;
  max-width: 100%;          /* never exceed wrapper width */
  border-radius: $radius-3;
  overflow: hidden;         /* safety if iframe tries to overflow */
  position: relative;
  z-index: 1;               /* under the ribbon */

  /* Placeholder surface while loading */
  @include theme-block {
    background: linear-gradient(180deg, tone(background-100, light), tone(surface, light));
    border: 1px solid rgba(0,0,0,.08);
  }
  @include theme-block-dark {
    background: linear-gradient(180deg, tone(background-200, dark), tone(surface, dark));
    border: 1px solid rgba(255,255,255,.12);
  }
}

/* ---------- Responsive variants (pure CSS) ---------- */

/* Square family */
.ad--square .ad__slot {
  aspect-ratio: 1 / 1;
  max-width: clamp(200px, 48vw, 336px);
  margin-inline: auto;
  min-height: clamp(180px, 40vw, 336px);
}

.ad--square-small .ad__slot {
  aspect-ratio: 1 / 1;
  max-width: clamp(160px, 40vw, 250px);
  margin-inline: auto;
  min-height: clamp(140px, 34vw, 250px);
}

.ad--square-large .ad__slot {
  aspect-ratio: 1 / 1;
  max-width: clamp(250px, 56vw, 420px);
  margin-inline: auto;
  min-height: clamp(220px, 50vw, 420px);
}

/* Horizontal (leaderboard-like) — fluid inside parent, but capped */
.ad--horizontal .ad__slot {
  width: 100%;
  max-width: 970px;                   /* typical cap for large leaderboards */
  margin-inline: auto;
  min-height: clamp(50px, 10vw, 90px);
}

/* Vertical (skyscraper-like) */
.ad--vertical .ad__slot {
  max-width: clamp(120px, 44vw, 300px);
  margin-inline: auto;
  min-height: clamp(300px, 60vh, 600px);
}

/* Fluid / In-article / Autorelaxed — let height breathe, width = parent */
.ad--fluid .ad__slot      { width: 100%; max-width: 100%; min-height: 200px; }
.ad--in_article .ad__slot { width: 100%; max-width: 100%; min-height: 180px; }
.ad--autorelaxed .ad__slot{ width: 100%; max-width: 100%; min-height: 240px; }

/* Slightly tweak at breakpoints */
@include mq-up($bp-md) {
  .ad--horizontal .ad__slot { min-height: clamp(60px, 7vw, 90px); }
  .ad--vertical   .ad__slot { min-height: clamp(400px, 60vh, 700px); }
}
@include mq-up($bp-lg) {
  .ad--square .ad__slot       { max-width: 336px; }
  .ad--square-small .ad__slot { max-width: 250px; }
  .ad--square-large .ad__slot { max-width: 420px; }
}


// ======================================================================
// ads-rails.scss — left/right skyscraper rails outside the main island
// Depends on: _variables.scss, adsense.scss (for .ad variants)
// ======================================================================


/* Hidden by default on small screens; we enable at wide widths */
.ad-rails { display: none; }

/* Show rails on large viewports so they don't overlap content.
   Tune this threshold: 1400px is a good starting point. */
@media (min-width: 1400px) {
  .ad-rails { display: block; }

  .ad-rail {
    position: fixed;
    top: calc(#{$navbar-height} + #{$sp-8});  /* clear your header */
    z-index: $z-base;                          /* under modals, over content */
    width: 300px;                              /* AdSense vertical common width */
    max-width: 300px;
    margin:10px;
    /* Let the ad component size itself; our wrapper just anchors it */
  }

  /* Align outside the centered island:
     50% to center, + half island, + container gutter, + small gap */
  .ad-rail--left {
    right: calc(50% + (#{$island-width} / 2) + #{$container-gutter} + #{$sp-8});
  }
  .ad-rail--right {
    left:  calc(50% + (#{$island-width} / 2) + #{$container-gutter} + #{$sp-8});
  }

  /* Make sure the contained ad never overflows its rail box */
  .ad-rail .ad { width: 100%; max-width: 100%; margin-block: 0; }
  .ad-rail .ad__slot { width: 100%; max-width: 100%; }

  /* Optional: keep the rail ad roughly within viewport height */
  .ad-rail .ad--vertical .ad__slot {
    min-height: clamp(400px, 70vh, 700px);
  }
}

/* If you need to nudge rails for ultra-wide or narrower thresholds, add more MQs: */
/*
@media (min-width: 1800px) {
  .ad-rail--left  { right: calc(50% + (#{$island-width} / 2) + #{$container-gutter} + #{$sp-12}); }
  .ad-rail--right { left:  calc(50% + (#{$island-width} / 2) + #{$container-gutter} + #{$sp-12}); }
}
*/
